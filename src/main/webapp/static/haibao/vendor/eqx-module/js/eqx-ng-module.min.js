angular.module("eqxAuth",["eqxDialog"]).provider("authService",function(){var e="http://localhost";this.setConfig=function(t){e=t.host||e},this.$get=["dialogService","authMessageType",function(t,a){function n(n){var o="";switch(n.type){case a.LOGIN:o="/auth/login";break;case a.REGISTER:o="/auth/register";break;case a.REGISTER_ENTERPRISE:o="/auth/register/mobile/2";break;case a.RESET:o="/auth/reset/"+n.resetToken}return t.open({template:r.replace("{{src}}",e+o+"?t="+Date.now()),plain:!0})}var r='<div class="eqc-auth" ng-style="dialogSize" eqd-message-event><iframe class="eqc-auth" src="{{src}}" frameborder="0" scrolling="no" ng-style="domSize"></iframe></div>';return{showAuth:n}}]}).constant("authMessageType",{LOGIN:"login",REGISTER:"register",REGISTER_ENTERPRISE:"registerEnterprise",RESET:"reset",CLOSE:"close"}).directive("eqdMessageEvent",["authMessageType",function(e){function t(t,a){function n(a){var n=JSON.parse(a.data);n.type===e.CLOSE&&(n=void 0),t.closeThisDialog(n)}a.on("$destroy",function(){window.removeEventListener("message",n)}),window.addEventListener("message",n)}return{link:t}}]),angular.module("eqxDialog",["ngDialog"]).factory("dialogService",["$q","ngDialog",function(e,t){function a(a){var n=e.defer();a=angular.extend({appendTo:"body",showClose:!1},a);var r=t.open(a);return r.closePromise.then(function(e){var t=e.value;t&&"$document"!=t?n.resolve(t):n.reject()})["catch"](function(e){n.reject(e)}),n.promise}return{open:a}}]);
